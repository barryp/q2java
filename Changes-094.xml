<?xml version="1.0"?>
<changelog version="0.9.4">
  <comments>
    <para>
      There were 3 main changes made in this version: the "DOM"-estication of
      the map entities, revamping of the printing system to use the event-delegation
      model, and renaming of the server frame listener and support classes.   Also, the
      included copy of OpenXML has been updated to version 1.0.6, and javax.vecmath to 1.1-1.0.
    </para>
    <para>
      The "DOM"-estication of the map entities means that all the constructors
      for map entity classes (such as weapons, ammoboxes, doors, etc), now take
      DOM Element objects as an argument (instead of an array of Strings, which
      was the old way of doing things).  There were -so- many classes involved in 
      this change that I won't bother trying to list them all.  For the most part,
      the only change was in the declaration of the constructor - since the utility
      methods for reading spawn args hide most of the differences between the arg styles.
    </para>
    <para>
      The printing system was quite a mess before, with printing being handled in 
      several places such as the Player class, the CTF team class, and the Game class.
      Now, everything is unified with a single set of PrintEvent, PrintListener, and PrintSupport
      classes.  Player chats, team chats, debugging output, and localized announcements all
      now come through a single mechanism, that can easily be listened to, filtered, and
      even modified (for spam supression, bad word filtering, logging, telnet servers, etc).
    </para>
    <para>
      The changing of the server frame listener classes, and alteration of the method
      names in the Game class for adding and removing listeners also caused many many
      classes to be slightly changed.  But that was pretty much simple search/replace name
      change type stuff, and did't actually change the way things work.  So for most of those
      changes I won't bother actually listing them here either.
    </para>
  </comments>
  
  <dll>
    <fix author="Barry">
      javalink_generic.c now #includes stdlib.h to fix compile warning
      about getenv()
    </fix>  
  </dll>
  
  <class name="q2java.Engine">
    <addition author="Barry">
      Private constructor added to prevent people from trying
      to create instances of this class.    
    </addition>
  </class>
  
  <class name="q2java.Q2Recycler">
    <addition author="Barry">
      getHashtable() and put(Hashtable h) for handling Hashtables.
    </addition>
  </class>
    
  <class name="q2java.baseq2.GameObject">
    <change author="Barry">
      Constructor now takes a DOM Element object as an argument, and saves
      it in a fSpawnArgs field.  Since this is the granddaddy of just about
      all game object classes, every subclass now has to do likewise.
    </change>
  </class>
  
  <class name="q2java.baseq2.GenericBlaster">
    <fix author="Barry">
      fire() method was calling getPlayerViewAngles() on the weapon NativeEntity 
      instead of the Player NativeEntity. 
    </fix>
  </class>
  
  <class name="q2java.baseq2.Player">
    <change author="Barry">
      Class now implements PrintListener instead of LocaleListener
    </change>    
    <addition author="Barry">
      New (transient) "team" property added, with getTeam() and setTeam() methods.  
      The type of the team property is just a java.lang.Object, so anything could be
      used, from a simple String all they way up to a special "Team" class as CTF uses.
    </addition>    
    <change author="Barry">
      cmd_say() and cmd_say_team() now send print messages through the event model
      rather than directly broadcasting themselves.
    </change>    
    <change author="Barry">
      isTeammate() updated to check new "team" property.
    </change>   
    <removed author="Barry">
      localecast() no longer needed, now handled through the new printing system.
    </removed>   
    <change author="Barry">
      playerCommand() sends unrecognized commands as chats through the new printing system.
    </change>         
    <addition author="Barry">
      print() method is the single point now for all print messages being sent to a
      player.  This includes general chats, team chats, and localized game announcements.
    </addition>    
  </class>
  
  <class name="q2java.baseq2.event.PlayerEvent">
    <addition author="Leigh">
      toString() method to help with debugging.
    </addition>  
  </class>
  
  <class name="q2java.baseq2.event.RuleEvent">
    <addition author="Leigh">
      toString() method to help with debugging.
    </addition>  
  </class>
  
  <class name="q2java.baseq2.gui.PlayerMenu">
    <fix author="Brian H">
      Problem with player overflowing because of scrolling through
      menu too fast fixed by limiting menu motion to one move
      per server-frame.
    </fix>    
  </class>  
  
  <class name="q2java.core.DefaultLevelDocumentFactory">
    <addition author="Barry">
      parseAngle3f() and parsePoint3f() moved here from q2java.core.GameUtil
    </addition>    
  </class>
  
  <class name="q2java.core.FrameList">
    <removed author="Barry">
      Moved to the q2java.core.event package and renamed as ServerFrameSupport
    </removed>   
  </class>
  
  <class name="q2java.core.FrameListener">
    <change author="Barry">
      Deprecated in favor of the new, otherwise indentical q2java.core.event.ServerFrameListener
      interface.
    </change>   
  </class>

  <class name="q2java.core.Game">
    <change author="Barry">
      addFrameListener() deprecated in favor of the new, otherwise indentical addServerFrameListener()
      method.
    </change>   
    <removed author="Barry">
      addLocaleListener() and addPrintListener() no longer needed under the new printing system.
    </removed>  
    <addition author="Barry">
      addServerFrameListener() does what addFrameListener() used to do.
    </addition>  
    <addition author="Barry">
      Private constructor added to prevent people from trying
      to create instances of this class.    
    </addition>       
    <addition author="Barry">
      getPrintSupport() to get a reference to the object managing printing in the game.
    </addition>       
    <addition author="Barry">
      New variant of getResourceGroup() that takes a string as an argument.
    </addition>       
    <change author="Barry">
      removeFrameListener() deprecated in favor of the new, otherwise indentical removeServerFrameListener()
      method.
    </change>  
    <removed author="Barry">
      removeLocaleListener() and removePrintListener() no longer needed under the new printing system.
    </removed>     
    <addition author="Barry">
      removeServerFrameListener() does what removeFrameListener() used to do.
    </addition>  
    <fix author="Barry">
      serverCommand() now handles commands in the form [gamelet].[cmd] better.      
    </fix>
  </class>

  <class name="q2java.core.GameletManager">
    <change author="Leigh">
      addGamelet() and removeGamelet() now provide more feedback to the admin.
    </change>  
    <fix author="Barry">
      Gamelets loaded at startup from the command line or in the q2java.properties
      file that required a level change (such as CTF) weren't being initialized
      until the first level change.
    </fix>
  </class>
  
  <class name="q2java.core.GameUtil">
    <change author="Barry">
      Utility methods for dealing with spawnargs updated to work with DOM Element
      objects instead of arrays of strings.
    </change>
    <removed author="Barry">
      parseAngle3f() and parsePoint3f() moved to q2java.core.DefaultLevelDocumentFactory()
      since they were mainly used in parsing the default info embedded in Q2 maps.
    </removed>
  </class>
  
  <class name="q2java.core.LocaleListener">
    <removed author="Barry">
      This interface is no longer needed due to the new printing system.
    </removed>
  </class>
  
  <class name="q2java.core.OpenXMLFactory">
    <change author="Barry">
      readXMLDocument() and writeXMLDocument() now take Reader and Writer
      arguments instead of InputStream and OutputStream.
    </change>
  </class>  
  
  <class name="q2java.core.PrintListener">
    <removed author="Barry">
      This interface is no longer needed due to the new printing system.
    </removed>
  </class>
  
  <class name="q2java.core.ResourceGroup">
    <removed author="Barry">
      addLocaleListener(), removeLocaleListener() and localecast() taken out since
      the new printing system takes care of that.  The ResourceGroup class has been
      cut back so that now it is simply a cache for ResourceBundle objects.
    </removed>
  </class>
  
  <class name="q2java.core.XMLFactory">
    <change author="Barry">
      readXMLDocument() and writeXMLDocument() now take Reader and Writer
      arguments instead of InputStream and OutputStream.
    </change>
  </class>   
  
  <class name="q2java.core.XMLTools">
    <change author="Barry">
      readXMLDocument() and writeXMLDocument() now take Reader and Writer
      arguments instead of InputStream and OutputStream.
    </change>
  </class>   
  
  <class name="q2java.core.event.EventPack">
    <addition author="Leigh">
      A trace of events can be written to the debug log, either by setting
      the system property "q2java.debug.event=1" or through the new setDebugEvents()
      method.
    </addition>  
  </class>
 
  <class name="q2java.core.event.GenericEvent">
    <change author="Leigh">
      toString() cleaned up.
    </change>  
  </class>    
  
  <class name="q2java.core.event.PrintEvent">
    <addition author="Barry">
      New class to represent a message being sent to various PrintListeners.
    </addition>  
  </class>    
  
  <class name="q2java.core.event.PrintListener">
    <addition author="Barry">
      New interface for classes interesting in receiving PrintEvent objects.  There
      used to be a q2java.core.PrintListener interface, but this is quite a bit different.
    </addition>  
  </class>   
  
  <class name="q2java.core.event.PrintSupport">
    <addition author="Barry">
      New class for keeping track of PrintListeners, and firing PrintEvents off to them.
      There are two event-firing methods, one that fires off a simple message, and another
      that localizes the message for each active locale (English, Dutch, German, etc) and 
      fires each variation to the listeners that have specified that particular locale when 
      they registered themselves.
    </addition>  
  </class> 
  
  <class name="q2java.core.event.ServerFrameListener">
    <addition author="Barry">
      New interface that's identical to and replaces the old q2java.core.FrameListener
      interface (which has been deprecated).
    </addition>  
  </class>   
  
  <class name="q2java.core.event.ServerFrameSupport">
    <addition author="Barry">
      The old q2java.core.FrameList class, just renamed and moved to the q2java.core.event package.
    </addition>  
  </class>   
  
  <class name="q2java.ctf.CTFPlayer">
    <removed author="Barry">
      getTeam(), and isTeammate() now handled by similarly named methods in the q2java.baseq2.Player class.
    </removed>
    <change author="Barry">
      setTeam() changed to use the superclass setTeam() but ensures that a CTF Team
      object is being used.
    </change>    
  </class>

  <class name="q2java.ctf.GenericTech">
    <fix author="Brian H">
      Bad resource bundle name caused exception to be thrown if a player carrying a 
      tech touched another tech.
    </fix>    
  </class>

  <class name="q2java.ctf.Team">
    <change author="Barry">
      Team class no longer handles team chats, since the new printing system
      takes care of that.
    </change>  
  </class>
</changelog>